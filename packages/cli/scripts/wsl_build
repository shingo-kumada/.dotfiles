#!/bin/sh

# Abort the program if an error occurs during script execution
set -e

cd

sudo apt-get update
sudo apt-get install -y build-essential curl file git

if [ ! -f /usr/local/bin/brew ]; then
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    test -d ~/.linuxbrew && eval "$(~/.linuxbrew/bin/brew shellenv)"
    test -d /home/linuxbrew/.linuxbrew && eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
    test -r ~/.bash_profile && echo "eval \$($(brew --prefix)/bin/brew shellenv)" >>~/.bash_profile
    echo "eval \$($(brew --prefix)/bin/brew shellenv)" >>~/.profile
fi

brew bundle -v --file=~/dotfiles/Brewfile

stow -v -d ./dotfiles/packages -t ~ terminal editor

exec $SHELL -l

